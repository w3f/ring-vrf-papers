% !TEX root = main.tex

\subsection{Putting Together a NIZK and a $\ZKCont$  for Proving $\rel$} \label{sec:nizkR}

%TODO Check consistency with the preliminaries section
%$$\rel = \{(\bary, \barz; \barx, \baromega_1, \baromega_2):  (\bary, \barx; \baromega_1) \in \relone, (\barz, \barx; \baromega_2) \in \reltwo \},$$
Let $\ZKCont_{\relone}$ be a zk continuation for $\relone$ (from the preamble of this section) \liz{Where?} with public parameters $ \pp $ and 
let $\nizktwo$ be a NIZK for $\reltwo'$ defined as
$$\reltwo' = \{(X, \barz; \barx, b, \baromega_2): \ZKCont_{\relone}.\VerifyCom(\pp, X, \barx, b) =1\ 
\wedge \ (\barz, \barx; \baromega_2) \in \reltwo \},$$ 
with $\reltwo$ from the preamble of Section~\ref{sec:rvrf_cont}. Then we define the system $\nizkR$ for relation $\mathcal{R}$ 
from the preamble of this section as:
\begin{itemize}
\item $\nizkR.\Setup(1^{\lambda})\rightarrow (\crsR = (\crs,\crstwo), \twR = (\tw, \twtwo), \pp_\rel = \pp)$: Here,
$(\crs, \tw, \allowbreak \pp) \leftarrow \ZKCont_{\relone}.\Setup(1^{\lambda}, \relone)$, $(\crstwo, \twtwo) \leftarrow \nizktwo.\Setup(1^{\lambda})$.

%\item $\nizkR.\Gen: (\crsR) \mapsto (\ppR = \pp, \crspkR = (\crspk,\crspktwo), \crsvkR = (\crsvk,\crsvktwo))$ where 
%$(\crspk, \crsvk, \pp) \leftarrow \ZKCont_{\relone}.\Gen(\crs, \relone)$, \\ $(\crspktwo, \crsvktwo) \leftarrow \nizktwo.\Gen(\crstwo)$ 

\item $\nizkR.\Prove(\crsR,\bary, \barz; \barx, \baromega_1, \baromega_2 ) \rightarrow (\pi_1, \pi_2, X)$: Here 
$(X', \pi'_1, b')$ is generated by $\ZKCont_{\relone}.\Preprove(\crs, \allowbreak \bar{y}, \allowbreak \bar{x}, \baromega_1)$ and 
$(X, \pi_1, b)$ generated by  $\ZKCont_{\relone}.\Reprove(\crs, X', \allowbreak \pi_1', b')$ and $ \pi_2 $ is generated by
$ \nizktwo.\Prove(\crstwo, \allowbreak X, \allowbreak \barz; \allowbreak \barx, b, \baromega_2)$. 

\item $\nizkR.\Verify(\crsR,(\bary, \barz), (\pi_1, \pi_2, X)) \rightarrow 0/1$: It outputs $1$ iff 
$\ZKCont_{\relone}.\Verify(\crs, \allowbreak \bar{y}, \allowbreak X, \pi_1) = 1 $ and $ \nizktwo.\Verify(\crstwo, X, \barz, \pi_2) =1.$

\item $\nizkR.\Sim: (\twR, \bary, \barz) \mapsto (\pi_1, \pi_2, X)$ where 
$(\pi_1, X) \leftarrow \ZKCont_{\relone}.\Sim(\tw, \bary)$, $\pi_2 \leftarrow \nizktwo.\Sim(\twtwo, X, \barz)$.
 \end{itemize}
%\vspace{-0.5cm}

 
\begin{theorem}
	If $\ZKCont_{\relone}$ is a zk continuation for $\relone$ and $\nizktwo$ is a NIZK for $\reltwo'$ for some appropriately chosen public parameters $\pp$, 
	then the $\nizkR$ construction described above is a NIZK for $\rel$.
\end{theorem}

\textit{Proof Outline.} The correctness, knowledge soundness and zk properties of $ \nizkR $ come from the same properties of $ \ZKCont_{\relone} $ and $ \nizktwo $. 
The proof can be found in the full version of the paper, at this anonymous link~\cite{anonymous}.
%The proof can be found in Appendix \ref{ap:nizkR}.
